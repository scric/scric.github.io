---
layout: post
title: 实用的批处理工具（二）
author: 张大星
date: 2017-12-09 12:16:54
tags: Tool  Windows
category: 批处理
---
* content
{:toc}

关于批量修改文件后缀 & 移动相应后缀文件





### 批量修改文件后缀

有个需求是，**需要将一些缓存文件修改为指定文件**。

比如电脑端 QQ 音乐缓冲下来的音乐文件的后缀是 .uc（可以在 Cache 文件夹中找到，并通过文件大小来判断是否为音乐文件），但有一个问题是无法直接用播放器来直接播放该文件。

一个很简单的办法是将其后缀由 .uc 修改为 .mp3，就可以直接播放了，这是其中一个问题。~~另一个问题是，文件名为某种“散乱”数字组成比如“434974723-128-3ccd141aaced059537a05d7c0fa203ca ”，而不是歌名。~~

但是如果一个一个修改后缀名无疑非常耗时间。不过使用批处理脚本可能会更加方便了，并且代码十分之简单。

模板：

     ren *.目标后缀名 *.目的后缀名     

代码实例：
  
     ren *.uc *.mp3  
  
作用是**将该目录下所有以 .uc 为后缀名的文件修改为以 .mp3 为后缀名的文件**。你可以将上述代码复制到文档当中，并将文档后缀修改为 .bat，最后把这个文件移动到 cache 文件夹中再双击运行，最后你会发现 cache 文件夹中的所有 .uc 文件都被修改为 .mp3 文件了。

#### 举一反三

1. 指定目录。在任意位置打开脚本文件都能将指定目录下的相应文件修改为你想要的文件格式。比如，都能将 I:\movies 盘符下的 .rmvb 格式的文件修改为以 .mkv结尾的文件。

### 移动相应后缀的文件

有一个需求是，**需要将文件移动到指定目录。**

比如自己每次随时截屏都将其保存在桌面上，时间一长桌面就不太整洁，但又不能删除，要留作记录，所以得定时将其移动到指定文件夹，但每次都要手动移动，步骤很繁琐，有没有更简单的办法呢？最好一步到位。另一个是，自己每次创建文本或者阅读文档时都习惯将其放在桌面上，所以也需要一个更好的方法来归类。

这时候使用批处理脚本就很简单了。

代码模板：

    robocopy 目标目录 目的目录 /s *.目标文件   
  
代码实例：
  
    robocopy C:\Users\scric\Desktop D:\oc /s *.txt *.docx *.doc *.xls *.pptx *.ppt *.md 
  
**作用**：将 `C:\Users\scric\Desktop` 下的所有以 `*.txt *.docx *.doc *.xls *.pptx *.ppt *.md` 结尾的文件移动到 `D:\oc` 下。

#### 举一反三

1. 如何点击一个批处理脚本就能实现“将同一目录下的不同格式的文件移动到不同目录下”？比如将 `桌面` 的 `.jpg` 文件移动到 `图片文件夹` 中，而 `桌面` 的 `.rmvb` 文件移动到 `影片文件夹` 中
2. 如何让该批处理脚本自启动？这样不用每次都点击该脚本来移动文件了。
3. 如何定期整理文件？比如每隔两天整理一次文件。

参考链接：[使用 RoboCopy 命令](http://www.cnblogs.com/xinyuxin912/archive/2013/07/10/3181564.html)




